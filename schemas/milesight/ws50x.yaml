# Milesight IoT WS503
name: milesight_ws50x
version: 1
endian: little

fields:
  - tlv:
      tag_fields:
        - name: channel_id
          type: u8
        - name: channel_type
          type: u8
      tag_key: [channel_id, channel_type]
      cases:
        # IPSO VERSION
        "[255, 1]":
          - name: ipso_version
            type: u8
            # raw: readProtocolVersion(bytes[i])
        # HARDWARE VERSION
        "[255, 9]":
          - name: hardware_version
            type: u8
            # raw: readHardwareVersion(bytes.slice(i, i + 2))
        # FIRMWARE VERSION
        "[255, 10]":
          - name: firmware_version
            type: u8
            # raw: readFirmwareVersion(bytes.slice(i, i + 2))
        # TSL VERSION
        "[255, 255]":
          - name: tsl_version
            type: u8
            # raw: readTslVersion(bytes.slice(i, i + 2))
        # SERIAL NUMBER
        "[255, 8]":
          - name: sn
            type: u8
            # raw: readSerialNumber(bytes.slice(i, i + 6))
        # LORAWAN CLASS TYPE
        "[255, 15]":
          - name: lorawan_class
            type: u8
            # raw: readLoRaWANClass(bytes[i])
        # RESET EVENT
        "[255, 254]":
          - name: reset_event
            type: u8
            # raw: readResetEvent(1)
        # DEVICE STATUS
        "[255, 11]":
          - name: device_status
            type: u8
            # raw: readDeviceStatus(1)
        # SWITCH STATE
        "[255, 41]":
          - name: switch_1
            type: u8
            # raw: readOnOffStatus((value >>> 0) & 1)
          - name: switch_1_change
            type: u8
            # raw: readYesNoStatus((value >>> 4) & 1)
          - name: switch_2
            type: u8
            # raw: readOnOffStatus((value >>> 1) & 1)
          - name: switch_2_change
            type: u8
            # raw: readYesNoStatus((value >>> 5) & 1)
          - name: switch_3
            type: u8
            # raw: readOnOffStatus((value >>> 2) & 1)
          - name: switch_3_change
            type: u8
            # raw: readYesNoStatus((value >>> 6) & 1)
        # BUTTON STATUS
        "[255, 43]":
          - name: function_key_event
            type: u8
            # raw: readYesNoStatus(1)
