# Milesight IoT GS301
name: milesight_gs301
version: 1
endian: little

fields:
  - tlv:
      tag_fields:
        - name: channel_id
          type: u8
        - name: channel_type
          type: u8
      tag_key: [channel_id, channel_type]
      cases:
        # IPSO VERSION
        "[255, 1]":
          - name: ipso_version
            type: u8
            # raw: readProtocolVersion(bytes[i])
        # HARDWARE VERSION
        "[255, 9]":
          - name: hardware_version
            type: u8
            # raw: readHardwareVersion(bytes.slice(i, i + 2))
        # FIRMWARE VERSION
        "[255, 10]":
          - name: firmware_version
            type: u8
            # raw: readFirmwareVersion(bytes.slice(i, i + 2))
        # DEVICE STATUS
        "[255, 11]":
          - name: device_status
            type: u8
            # raw: readOnOffStatus(1)
        # LORAWAN CLASS
        "[255, 15]":
          - name: lorawan_class
            type: u8
            # raw: readLoRaWANClass(bytes[i])
        # PRODUCT SERIAL NUMBER
        "[255, 22]":
          - name: sn
            type: u8
            # raw: readSerialNumber(bytes.slice(i, i + 8))
        # TSL VERSION
        "[255, 255]":
          - name: tsl_version
            type: u8
            # raw: readTslVersion(bytes.slice(i, i + 2))
        # BATTERY
        "[1, 117]":
          - name: battery
            type: u8
            # raw: readUInt8(bytes[i])
        # TEMPERATURE
        "[2, 103]":
          - name: temperature
            type: s16
            div: 10
        # HUMIDITY
        "[3, 104]":
          - name: humidity
            type: u8
            # raw: readUInt8(bytes[i]) / 2
        # NH3
        "[4, 125]":
          - name: nh3_sensor_status
            type: u8
            # raw: readSensorStatus(nh3_raw_data)
          - name: nh3
            type: u8
            # raw: nh3_raw_data / 100
        # H2S
        "[5, 125]":
          - name: h2s_sensor_status
            type: u8
            # raw: readSensorStatus(h2s_raw_data)
          - name: h2s
            type: u8
            # raw: h2s_raw_data / 100
        # H2S (@since v1.2)
        "[6, 125]":
          - name: h2s_sensor_status
            type: u8
            # raw: readSensorStatus(h2s_raw_data)
          - name: h2s
            type: u8
            # raw: h2s_raw_data / 1000
        # SENSOR CALIBRATION RESULT (@since v1.2)
        "[7, 234]":
          - name: nh3_calibration_result
            type: u8
            # raw: {
        # SENSOR ID (@since v1.2)
        "[255, 124]":
          - name: sensor_id
            type: u8
            # raw: readAscii(bytes.slice(i, i + 43))
