# https://www.decentlab.com/products/soil-moisture-temperature-and-electrical-conductivity-sensor-for-lorawan
name: decentlab_dl_trs12
version: 2
endian: big

fields:
  - name: protocol_version
    type: u8
  - name: device_id
    type: u16
  - name: flags
    type: u16

  - flagged:
      field: flags
      groups:
        - bit: 0
          fields:
            - name: dielectric_permittivity
              type: u16
              # formula: Math.pow(0.000000002887 * Math.pow(x[0]/10, 3) - 0.0000208 * Math.pow(x[0]/10, 2) + 0.05276 * (x[0]/10) - 43.39, 2)
            - name: volumetric_water_content
              type: u16
              unit: "m³⋅m⁻³"
              # formula: x[0]/10 * 0.0003879 - 0.6956
            - name: soil_temperature
              type: s16
              div: 10
              unit: "°C"
            - name: electrical_conductivity
              type: u16
              unit: "µS⋅cm⁻¹"
        - bit: 1
          fields:
            - name: battery_voltage
              type: u16
              div: 1000
              unit: "V"
