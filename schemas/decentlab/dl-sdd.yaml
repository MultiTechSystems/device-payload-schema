# https://www.decentlab.com/products/soil-moisture-temperature-and-salinity-profile
name: decentlab_dl_sdd
version: 2
endian: big

fields:
  - name: protocol_version
    type: u8
  - name: device_id
    type: u16
  - name: flags
    type: u16

  - flagged:
      field: flags
      groups:
        - bit: 0
          fields:
            - name: moisture_at_level_0
              type: s16
              div: 100
              unit: "%"
            - name: moisture_at_level_1
              type: s16
              div: 100
              unit: "%"
            - name: moisture_at_level_2
              type: s16
              div: 100
              unit: "%"
            - name: moisture_at_level_3
              type: s16
              div: 100
              unit: "%"
            - name: moisture_at_level_4
              type: s16
              div: 100
              unit: "%"
            - name: moisture_at_level_5
              type: s16
              div: 100
              unit: "%"
            - name: temperature_at_level_0
              type: s16
              div: 100
              unit: "°C"
            - name: temperature_at_level_1
              type: s16
              div: 100
              unit: "°C"
            - name: temperature_at_level_2
              type: s16
              div: 100
              unit: "°C"
            - name: temperature_at_level_3
              type: s16
              div: 100
              unit: "°C"
            - name: temperature_at_level_4
              type: s16
              div: 100
              unit: "°C"
            - name: temperature_at_level_5
              type: s16
              div: 100
              unit: "°C"
            - name: salinity_at_level_0
              type: u16
              add: -100
            - name: salinity_at_level_1
              type: u16
              add: -100
            - name: salinity_at_level_2
              type: u16
              add: -100
            - name: salinity_at_level_3
              type: u16
              add: -100
            - name: salinity_at_level_4
              type: u16
              add: -100
            - name: salinity_at_level_5
              type: u16
              add: -100
        - bit: 1
          fields:
            - name: moisture_at_level_6
              type: s16
              div: 100
              unit: "%"
            - name: moisture_at_level_7
              type: s16
              div: 100
              unit: "%"
            - name: moisture_at_level_8
              type: s16
              div: 100
              unit: "%"
            - name: moisture_at_level_9
              type: s16
              div: 100
              unit: "%"
            - name: moisture_at_level_10
              type: s16
              div: 100
              unit: "%"
            - name: moisture_at_level_11
              type: s16
              div: 100
              unit: "%"
            - name: temperature_at_level_6
              type: s16
              div: 100
              unit: "°C"
            - name: temperature_at_level_7
              type: s16
              div: 100
              unit: "°C"
            - name: temperature_at_level_8
              type: s16
              div: 100
              unit: "°C"
            - name: temperature_at_level_9
              type: s16
              div: 100
              unit: "°C"
            - name: temperature_at_level_10
              type: s16
              div: 100
              unit: "°C"
            - name: temperature_at_level_11
              type: s16
              div: 100
              unit: "°C"
            - name: salinity_at_level_6
              type: u16
              add: -100
            - name: salinity_at_level_7
              type: u16
              add: -100
            - name: salinity_at_level_8
              type: u16
              add: -100
            - name: salinity_at_level_9
              type: u16
              add: -100
            - name: salinity_at_level_10
              type: u16
              add: -100
            - name: salinity_at_level_11
              type: u16
              add: -100
        - bit: 2
          fields:
            - name: battery_voltage
              type: u16
              div: 1000
              unit: "V"
