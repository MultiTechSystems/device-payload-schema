/*
 * env_sensor_codec.h - Auto-generated codec for env_sensor
 *
 * Generated by: generate-c.py
 * Generated at: 2026-02-05T08:05:29.822372
 * Schema version: 1.0
 *
 * DO NOT EDIT - Regenerate from schema
 */

#ifndef _ENV_SENSOR_CODEC_H_
#define _ENV_SENSOR_CODEC_H_

#include "rt.h"

#ifdef __cplusplus
extern "C" {
#endif

/* ============================================
 * Constants
 * ============================================ */

#define ENV_SENSOR_VERSION "1.0"

/* ============================================
 * Data Structure
 * ============================================ */

typedef struct {
    s2_t temperature;
    u1_t humidity;
    u2_t battery_mv;
    u1_t status;
} env_sensor_t;

/* ============================================
 * Decoder
 * ============================================ */

/**
 * Decode env_sensor payload from bytes
 *
 * @param buf    Input buffer
 * @param len    Input length
 * @param out    Output structure
 * @return       Bytes consumed on success, negative on error
 *               -1: Invalid parameters
 *               -2: Buffer too short
 */
static inline int decode_env_sensor(
    const u1_t* buf,
    size_t len,
    env_sensor_t* out
) {
    if (!buf || !out) return -1;
    memset(out, 0, sizeof(*out));
    size_t pos = 0;

    /* temperature: i16 */
    if (pos + 2 > len) return -2;
    out->temperature = read_u2_le(buf + pos);
    pos += 2;
    /* Note: apply mult 0.01 in application */

    /* humidity: u8 */
    if (pos + 1 > len) return -2;
    out->humidity = buf[pos];
    pos += 1;
    /* Note: apply mult 0.5 in application */

    /* battery_mv: u16 */
    if (pos + 2 > len) return -2;
    out->battery_mv = read_u2_le(buf + pos);
    pos += 2;

    /* status: u8 */
    if (pos + 1 > len) return -2;
    out->status = buf[pos];
    pos += 1;

    return (int)pos;  /* bytes consumed */
}

/* ============================================
 * Encoder
 * ============================================ */

/**
 * Encode env_sensor payload to bytes
 *
 * @param in      Input structure
 * @param buf     Output buffer
 * @param max_len Maximum buffer size
 * @return        Bytes written on success, negative on error
 */
static inline int encode_env_sensor(
    const env_sensor_t* in,
    u1_t* buf,
    size_t max_len
) {
    if (!in || !buf) return -1;
    size_t pos = 0;

    /* temperature: i16 */
    if (pos + 2 > max_len) return -2;
    write_u2_le(buf + pos, in->temperature);
    pos += 2;

    /* humidity: u8 */
    if (pos + 1 > max_len) return -2;
    buf[pos] = in->humidity;
    pos += 1;

    /* battery_mv: u16 */
    if (pos + 2 > max_len) return -2;
    write_u2_le(buf + pos, in->battery_mv);
    pos += 2;

    /* status: u8 */
    if (pos + 1 > max_len) return -2;
    buf[pos] = in->status;
    pos += 1;

    return (int)pos;  /* bytes written */
}

#ifdef __cplusplus
}
#endif

#endif /* _ENV_SENSOR_CODEC_H_ */
